<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Auto Chaos Snake üêçüí•</title>
<style>
  body {
    margin: 0;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
    transition: background 0.15s;
    font-family: "Comic Sans MS", cursive, sans-serif;
    color: white;
  }
  canvas {
    background: #111;
    border: 3px solid #0f0;
    box-shadow: 0 0 20px #0f0;
  }
  #score {
    position: absolute;
    top: 10px;
    font-size: 24px;
  }
  .shake {
    animation: shake 0.3s;
  }
  @keyframes shake {
    0% { transform: translate(5px, 5px); }
    20% { transform: translate(-5px, -5px); }
    40% { transform: translate(-5px, 5px); }
    60% { transform: translate(5px, -5px); }
    80% { transform: translate(-5px, 5px); }
    100% { transform: translate(0, 0); }
  }
</style>
</head>
<body>
<div id="score">Score: 0</div>
<canvas id="game" width="400" height="400"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const grid = 20;
let snake = [{x: 200, y: 200}];
let dx = grid, dy = 0;
let apples = [{x: randPos(), y: randPos(), type: 'normal'}];
let score = 0;
let eaten = 0;
let autoPlay = false;
let speed = 100;
let rainbowColors = ['red','orange','yellow','lime','cyan','blue','magenta'];

function randPos() { return Math.floor(Math.random()*(canvas.width/grid))*grid; }

function drawSnake() {
  snake.forEach((s,i)=>{
    ctx.fillStyle = autoPlay ? rainbowColors[i % rainbowColors.length] : (i===0?'lime':'cyan');
    ctx.fillRect(s.x,s.y,grid,grid);
    ctx.strokeStyle = '#111';
    ctx.strokeRect(s.x,s.y,grid,grid);
  });
}

function drawApples() {
  apples.forEach(a=>{
    ctx.fillStyle = a.type==='speed'?'yellow':(a.type==='slow'?'blue':'red');
    ctx.fillRect(a.x,a.y,grid,grid);
  });
}

function flashBG() {
  const colors = ['#ff0000','#00ff00','#0000ff','#ffff00','#ff00ff','#00ffff','#ffffff'];
  document.body.style.background = colors[Math.floor(Math.random()*colors.length)];
  setTimeout(()=>{document.body.style.background = '#000';},150);
}

function shakeScreen() {
  document.body.classList.add('shake');
  setTimeout(()=>document.body.classList.remove('shake'),300);
}

function spawnApple(type='normal'){ return {x:randPos(),y:randPos(),type}; }

function update() {
  // Move head
  let head = {x: snake[0].x + dx, y: snake[0].y + dy};
  snake.unshift(head);

  let ate = false;
  for(let i=apples.length-1;i>=0;i--){
    if(head.x===apples[i].x && head.y===apples[i].y){
      ate = true;
      eaten++;
      score +=10;
      scoreEl.textContent = 'Score: '+score;
      flashBG();
      shakeScreen();

      // Apply apple effect
      if(apples[i].type==='speed' && speed>50){ speed-=10; clearInterval(loopId); loopId=setInterval(gameLoop,speed);}
      if(apples[i].type==='slow'){ speed+=20; clearInterval(loopId); loopId=setInterval(gameLoop,speed);}
      if(apples[i].type==='double'){ snake.push({...snake[snake.length-1]}); }

      apples.splice(i,1);

      // Chaos apples
      if(eaten %4 ===0){
        for(let j=0;j<3;j++) apples.push(spawnApple());
      }
      apples.push(spawnApple());
      break;
    }
  }
  if(!ate) snake.pop();

  // Collision
  if(head.x<0 || head.y<0 || head.x>=canvas.width || head.y>=canvas.height || snake.slice(1).some(s=>s.x===head.x && s.y===head.y)){
    alert('Game Over! Score: '+score);
    document.location.reload();
  }

  // Victory mode
  if(snake.length >= (canvas.width/grid)*(canvas.height/grid)*0.7){
    alert('VICTORY! You filled the board!');
    document.location.reload();
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawSnake();
  drawApples();
}

// Controls
document.addEventListener('keydown',e=>{
  if(autoPlay) return;
  if(e.key==='ArrowLeft' && dx===0){dx=-grid; dy=0;}
  else if(e.key==='ArrowUp' && dy===0){dx=0; dy=-grid;}
  else if(e.key==='ArrowRight' && dx===0){dx=grid; dy=0;}
  else if(e.key==='ArrowDown' && dy===0){dx=0; dy=grid;}
});

// Auto move
function autoMove(){
  if(!autoPlay || apples.length===0) return;
  let target = apples[0];
  let head = snake[0];
  if(head.x<target.x && dx===0) {dx=grid; dy=0;}
  else if(head.x>target.x && dx===0) {dx=-grid; dy=0;}
  else if(head.y<target.y && dy===0) {dx=0; dy=grid;}
  else if(head.y>target.y && dy===0) {dx=0; dy=-grid;}
}

let loopId;
function gameLoop(){
  if(eaten>=3) autoPlay=true;
  autoMove();
  update();
}

loopId=setInterval(gameLoop,speed);
</script>
</body>
</html>

